---
title: "Assginment03"
author: "Zhen Liu"
date: "2022-10-14"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Exploratory data analysis




```{r}

library(tidyverse)
library(Stat2Data)
data("Hawks")
```

```{r}
head(Hawks)

```
### 1.1 Location estimators

#### Q1 

```{r}


HawksTail<-Hawks[['Tail']]

HawksTail
```
```{r}

class(HawksTail)

mean(HawksTail)


median(HawksTail)
```
### 1.2 Combining location estimators with the summarise function 
#### Q1

```{r}

hawksFullName%>%
  summarise(Wing_mean= mean(Wing,na.rm = TRUE),Wing_t_mean = mean(Wing,na.rm = TRUE,trim = 0.5), Wing_med = median(Wing,na.rm = TRUE),Weight_mean= mean(Weight,na.rm = TRUE),Weight_t_mean = mean(Weight,na.rm = TRUE,trim = 0.5), Weight_med = median(Weight,na.rm = TRUE))


```
#### Q2
```{r}


hawksFullName%>%
  group_by(Species)%>%
  summarise(Wing_mean= mean(Wing,na.rm = TRUE),Wing_t_mean = mean(Wing,na.rm = TRUE,trim = 0.5), Wing_med = median(Wing,na.rm = TRUE),Weight_mean= mean(Weight,na.rm = TRUE),Weight_t_mean = mean(Weight,na.rm = TRUE,trim = 0.5), Weight_med = median(Weight,na.rm = TRUE))



```

### 1.3 Location and dispersion estimators under linear transformations 

#### Q1

```{r}

a<- 2
b<-3

mean(HawksTail*a +b)

mean(HawksTail)

```
The mean of HawksTail*a +b is almost double times as HawksTail

#### Q2

```{r}

var(HawksTail*a +b)
var(HawksTail)

sd(HawksTail*a +b)
sd(HawksTail)
```
The variance of HawksTail*a +b is almost four times as HawksTail
The standard deviation of HawksTail*a +b is almost two times as HawksTail

### 1.4 Robustness of location estimators


```{r}

hal<-Hawks$Hallux # Extract the vector of hallux lengths 
hal<-hal[!is.na(hal)] # Remove any nans

```

```{r}
outlier_val<-100 
num_outliers<-10

corrupted_hal<-c(hal,rep(outlier_val,times=num_outliers))

mean(hal)
mean(corrupted_hal)


```

```{r}
num_outliers_vect <- seq(0,1000) 
means_vect <- c() 
for(num_outliers in num_outliers_vect){
  corrupted_hal <-c(hal,rep(outlier_val,times=num_outliers)) 
  means_vect <- c(means_vect, mean(corrupted_hal))
}
```

#### Q1

```{r}

medians_vect<-c()
for(num_outliers in num_outliers_vect){
  corrupted_hal<-c(hal,rep(outlier_val,times=num_outliers))
  medians_vect<-c(medians_vect,median(corrupted_hal))
}

```

#### Q2

```{r}
t_means_vect<-c()
for(num_outliers in num_outliers_vect){
  corrupted_hal<-c(hal,rep(outlier_val,times=num_outliers))
  t_means_vect<-c(t_means_vect,mean(corrupted_hal,trim = 0.1))
}
```

#### Q3
```{r}

df_means_medians <-
  data.frame(num_outliers=num_outliers_vect,
             mean=means_vect, t_mean=t_means_vect,
             median=medians_vect)


```

```{r}

df_means_medians %>% pivot_longer(!num_outliers,
                                  names_to = "Estimator", values_to = "Value") %>%
  ggplot(aes(x=num_outliers,color=Estimator,
             linetype=Estimator,y=Value)) +
  geom_line()+xlab("Number of outliers")



```
### 1.5 Box plots and outliers

```{r}


ggplot(Hawks,aes(x=Species,y=Weight)) +
  geom_boxplot()+xlab("Species") + ylab("Weight")



```
#### Q2

```{r}

q =c(0.25,0.5,0.75)

Hawks%>%
  group_by(Species)%>%
  summarise(quantile025 = quantile(Weight, probs = q[1],na.rm=TRUE),
            quantile050 = quantile(Weight, probs = q[2],na.rm=TRUE),
            quantile075 = quantile(Weight, probs = q[3],na.rm=TRUE))

```
#### Q3

```{r}
num_outliers<- function(input_sample){
  quantile25<- quantile(input_sample,0.25, na.rm = TRUE)
  quantile75<- quantile(input_sample,0.75, na.rm = TRUE)
  iq_range<- quantile75 - quantile25
  outliers <- input_sample[(input_sample>quantile75+1.5*iq_range)| (input_sample<quantile25-1.5*iq_range)]
  n<-length(outliers)
  return(n)
}

num_outliers(c(0,40,60,185))
```
#### Q4


```{r}





```



